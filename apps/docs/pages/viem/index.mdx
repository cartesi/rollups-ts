# Viem Extension

This is a [viem](https://viem.sh) extension library that helps with the development of Cartesi applications, especially frontend applications that run in the browser.

It provides actions that complement the L1 public and wallet actions, by providing convenient methods for interacting with Cartesi rollups [smart contracts](https://github.com/cartesi/rollups-contracts) infrastructure.

It also provides L2 public actions and a new `createCartesiPublicClient` client constructor that allows to interact with the Cartesi rollups [JSON-RPC API](https://playground.open-rpc.org/?schemaUrl=https://raw.githubusercontent.com/cartesi/rollups-node/refs/tags/v2.0.0-alpha.3/internal/jsonrpc/jsonrpc-discover.json&uiSchema[appBar][ui:title]=Cartesi&uiSchema[appBar][ui:logoUrl]=https://cartesi.io/favicon.svg&uiSchema[appBar][ui:transports]=false&uiSchema[appBar][ui:input]=false&uiSchema[appBar][ui:edit]=false&uiSchema[appBar][ui:examplesDropdown]=false&uiSchema[appBar][ui:splitView]=false).

## Wallet L1 Actions

Provides convenient methods to interact with Cartesi rollups smart contracts.
The `addInput` allows to send generic inputs to the `InputBox`, and there are methods to deposit assets to each of the asset portals: ERC-20, ERC-721 and ERC-1155.
There is also a method to execute outputs (vouchers).

```ts twoslash
import { walletActionsL1 } from "@cartesi/viem";
import { createWalletClient, http } from "viem";
import { cannon } from "viem/chains";

// create wallet client with extra L1 actions
const walletClient = createWalletClient({
    chain: cannon,
    transport: http(),
}).extend(walletActionsL1()); // [!code hl]

// @noErrors
walletClient.
//           ^|
```

If the user wants to use directly viem methods, or wagmi hooks, they can also use the `@cartesi/viem/abi` package to import properly type ABIs for all contracts managed by Cartesi rollups.

## Public L1 Actions

Provides convenient methods to interact with view methods of Cartesi rollups smart contracts.
This includes gas estimation methods for all wallet L1 actions, and also the `validateOutput` method.

```ts twoslash
import { publicActionsL1 } from "@cartesi/viem";
import { createPublicClient, http } from "viem";
import { cannon } from "viem/chains";

// create public client with extra L1 actions
const publicClient = createPublicClient({
    chain: cannon,
    transport: http(),
}).extend(publicActionsL1()); // [!code hl]

// @noErrors
publicClient.
//           ^|
```

If the user wants to use directly viem methods, or wagmi hooks, they can also use the `@cartesi/viem/abi` package to import properly type ABIs for all contracts managed by Cartesi rollups.

## Public L2 Actions

Provides convenient methods to interact with Cartesi JSON-RPC API, which provides read-only access to the app specific L2.
This includes methods to read applications managed by a node, inputs sent to applications, outputs generated by applications and epochs closed by node.

```ts twoslash
import { createCartesiPublicClient } from "@cartesi/viem";
import { http } from "viem";

// create cartesi public client to L2 with RPC url
const publicClientL2 = createCartesiPublicClient({ // [!code hl]
    transport: http("http://127.0.0.1:6751/rpc"), // [!code hl]
}); // [!code hl]

// @noErrors
publicClientL2.
//             ^|
```
